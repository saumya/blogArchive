<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" lang="en-US">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
<base href="http://saumya.github.io/blogArchive" />

<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<title>Dealing with Touch Events, the Sparrow way. | saumya</title>

<link rel="stylesheet" type="text/css" media="all" href="http://saumya.github.io/blogArchive/wp-content/themes/twentyeleven/style.css" />

<!--[if lt IE 9]>
<script src="http://saumya.github.io/blogArchive/wp-content/themes/twentyeleven/js/html5.js" type="text/javascript"></script>
<![endif]-->



<script type='text/javascript' src='http://saumya.github.io/blogArchive/wp-includes/js/comment-reply.min.js?ver=3.5'></script>

 

<link rel='next' title='Making random numbers in ObjectiveC, the quick and dirty way.' href='http://saumya.github.io/blogArchive/archives/278' />

<link rel='canonical' href='http://saumya.github.io/blogArchive/archives/264' />
<link rel='shortlink' href='http://saumya.github.io/blogArchive/?p=264' />
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #e2e2e2; }
</style>
</head>

<body class="single single-post postid-264 single-format-standard custom-background singular two-column right-sidebar">
<div id="page" class="hfeed">
	<header id="branding" role="banner">
			<hgroup>
				<h1 id="site-title"><span><a href="http://saumya.github.io/blogArchive/" title="saumya" rel="home">saumya</a></span></h1>
				<h2 id="site-description">Where there is a will, there is a way.</h2>
			</hgroup>

						<a href="http://saumya.github.io/blogArchive/">
									<img src="http://saumya.github.io/blogArchive/wp-content/uploads/2011/08/sanchi.jpg" width="1000" height="288" alt="" />
							</a>
			

			<nav id="access" role="navigation">
				<h3 class="assistive-text">Main menu</h3>
								<div class="skip-link"><a class="assistive-text" href="#content" title="Skip to primary content">Skip to primary content</a></div>
				<div class="skip-link"><a class="assistive-text" href="#secondary" title="Skip to secondary content">Skip to secondary content</a></div>
								<div class="menu"><ul><li ><a href="http://saumya.github.io/blogArchive/" title="Home">Home</a></li></ul></div>
			</nav><!-- #access -->
	</header><!-- #branding -->


	<div id="main">

		<div id="primary">
			<div id="content" role="main">

				
					<nav id="nav-single">
						<h3 class="assistive-text">Post navigation</h3>
						<span class="nav-previous"><a href="http://saumya.github.io/blogArchive/archives/242" rel="prev"><span class="meta-nav">&larr;</span> Previous</a></span>
						<span class="nav-next"><a href="http://saumya.github.io/blogArchive/archives/278" rel="next">Next <span class="meta-nav">&rarr;</span></a></span>
					</nav><!-- #nav-single -->

					
<article id="post-264" class="post-264 post type-post status-publish format-standard hentry category-ipad-development category-iphone-development category-objectivec category-opensource category-tutorial tag-ipad tag-iphone tag-objectivec tag-sparrow-framework">
	<header class="entry-header">
		<h1 class="entry-title">Dealing with Touch Events, the Sparrow way.</h1>

				<div class="entry-meta">
			<span class="sep">Posted on </span><a href="http://saumya.github.io/blogArchive/archives/264" title="3:58 pm" rel="bookmark"><time class="entry-date" datetime="2010-11-18T15:58:03+00:00">November 18, 2010</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="http://saumya.github.io/blogArchive/archives/author/saumya" title="View all posts by saumya" rel="author">saumya</a></span></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	<div class="entry-content">
		<p>This is specifically caught me, when I am coming from other object oriented technology. May be because of those environments are all single touch based. And I never have worked in multi-touch based application.<br />
While working in <a href="http://www.sparrow-framework.org/">Sparrow-framework</a>, there is a nice event called &#8220;SP_EVENT_TYPE_TOUCH&#8221; . This is basically used if we want to use the touch based interaction in our game. Once we add an handler to it, the general expectation is it will just fire up once per touch/tap. But actually it will fire up 2 times as we have 2 different events, &#8220;touchesBegan&#8221; and &#8220;touchesEnded&#8221; for each touch interaction in the main cocoa/objectiveC framework. And the good news is <a href="http://www.sparrow-framework.or">Sparrow-framework</a> does a nice job of encapsulating the internals of all those two events and gives us one event to deal with, that is &#8220;SP_EVENT_TYPE_TOUCH&#8221;.<br />
Well, but the catch is getting confused with the event handler code. Lets dive in here.</p>
<pre lang="objc" lineno="0">
[self addEventListener:@selector(onUserTouch:) 
	atObject:self forType:SP_EVENT_TYPE_TOUCH];
</pre>
<p>Now the handler code will look as below</p>
<pre lang="objc" lineno="0">
- (void)onUserTouch:(SPTouchEvent*)event
{
        NSLog(@"onUserTouch");
}
</pre>
<p>When run, this code will generate log messages two times for a single touch! Thats for the reason we discussed earlier. Well, the fix is on the handler. We have to deal the events inside if-else where we will check, whether its single or multi touch as below.</p>
<pre lang="objc" lineno="0">
- (void)onUserTouch:(SPTouchEvent*)event
{
        NSLog(@"onUserTouch");
        NSArray *touches = [[event touchesWithTarget:self 
                       andPhase:SPTouchPhaseBegan] allObjects];
	if (touches.count==1) {
		NSLog(@"1 fingure touch ");
               //Do the custom code here for single touch events
	}else if (touches.count==2) {
		NSLog(@"2 fingure touch ");
	}
}
</pre>
<p>For only single touch the syntax is even smaller</p>
<pre lang="objc" lineno="0">
- (void)onUserTouch:(SPTouchEvent*)event
 {
     SPTouch *touch = [[event touchesWithTarget:self 
                 andPhase:SPTouchPhaseBegan] anyObject];
     if (touch)
     {
         SPPoint *touchPosition = [touch locationInSpace:self];
         NSLog(@"Touched position (%f, %f)", 
              touchPosition.x, touchPosition.y);
     }
 }
</pre>
<p>The only difference being, while handling single touches we can directly use &#8220;<strong>anyObject</strong>&#8221; as the last parameter and that will give us a single event and for multi-touch environments we have to use &#8220;<strong>allObjects</strong>&#8221; as the last parameter. But all this will happen inside the event handler, which will by default fire up twice.<br />
<strong>One has to get the &#8220;touch&#8221; or &#8220;touches&#8221; inside the event handler and then process the code according to it. Directly the handler will fire up twice and that must not confuse as to, whats happening around!</strong></p>
<p>Happy coding <img src='http://saumya.github.io/blogArchive/wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
			</div><!-- .entry-content -->

	<footer class="entry-meta">
		This entry was posted in <a href="http://saumya.github.io/blogArchive/archives/category/ipad-development" title="View all posts in ipad development" rel="category tag">ipad development</a>, <a href="http://saumya.github.io/blogArchive/archives/category/iphone-development" title="View all posts in iphone development" rel="category tag">iphone development</a>, <a href="http://saumya.github.io/blogArchive/archives/category/objectivec" title="View all posts in objectiveC" rel="category tag">objectiveC</a>, <a href="http://saumya.github.io/blogArchive/archives/category/opensource" title="View all posts in opensource" rel="category tag">opensource</a>, <a href="http://saumya.github.io/blogArchive/archives/category/tutorial" title="View all posts in tutorial" rel="category tag">tutorial</a> and tagged <a href="http://saumya.github.io/blogArchive/archives/tag/ipad" rel="tag">ipad</a>, <a href="http://saumya.github.io/blogArchive/archives/tag/iphone" rel="tag">iphone</a>, <a href="http://saumya.github.io/blogArchive/archives/tag/objectivec" rel="tag">objectiveC</a>, <a href="http://saumya.github.io/blogArchive/archives/tag/sparrow-framework" rel="tag">sparrow-framework</a> by <a href="http://saumya.github.io/blogArchive/archives/author/saumya">saumya</a>. Bookmark the <a href="http://saumya.github.io/blogArchive/archives/264" title="Permalink to Dealing with Touch Events, the Sparrow way." rel="bookmark">permalink</a>.		
			</footer><!-- .entry-meta -->
</article><!-- #post-264 -->

						<div id="comments">
	
	
	
									
</div><!-- #comments -->

				
			</div><!-- #content -->
		</div><!-- #primary -->


	</div><!-- #main -->

	<footer id="colophon" role="contentinfo">

			

			<div id="site-generator">

								
				<!--
				<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a>
				-->

				<a href="http://wordpress.org/">It was Proudly powered by WordPress. ( 2010 - 2014 ) </a>
				
			</div>
	</footer><!-- #colophon -->
</div><!-- #page -->


</body>
</html>